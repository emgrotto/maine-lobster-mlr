
Extracting Lobster Data from: https://www.maine.gov/dmr/fisheries/commercial/landings-data

Extracting Extreme weather Data from: https://www.ncei.noaa.gov/access/monitoring/cei/ 

Extracting Sea Surface temperature Data from: https://www.maine.gov/dmr/science/weather-tides/boothbay-harbor-environmental-data

Creating the Desgin matrix for the 31 observations
    ones    cei  sea_avg_max  sea_avg_min  sea_max_range  years
0      1  14.60        9.600        7.400         20.800   1989
1      1  43.68        9.300        8.100         19.600   1990
2      1  30.10        9.650        8.450         17.200   1991
3      1  15.20        8.600        7.500         18.000   1992
4      1   4.38        9.100        7.650         20.600   1993
5      1   8.30        9.900        8.300         24.700   1994
6      1   7.86       10.300        8.900         19.500   1995
7      1  29.04        9.740        8.200         19.880   1996
8      1   7.86        8.320        6.551         18.006   1997
9      1  49.10        9.260        7.760         20.332   1998
10     1  41.20       10.510        8.840         21.763   1999
11     1  10.62       10.185        8.935         21.622   2000
12     1  25.26       10.475        8.975         22.711   2001
13     1  20.88       10.330        8.490         23.746   2002
14     1  30.84       10.190        8.690         23.766   2003
15     1  20.00       10.160        8.670         73.910   2004
16     1  27.28       11.840       10.040         23.457   2005
17     1  71.80       12.590       11.800         28.948   2006
18     1  10.24       11.240        6.371         38.640   2007
19     1  24.70       11.480        7.620         32.740   2008
20     1  15.76       10.190        8.475         35.580   2009
21     1  42.28        9.980        8.390         25.592   2010
22     1  70.32       10.520        8.480         22.956   2011
23     1  50.72       10.370        8.645         23.227   2012
24     1  18.74       10.165        8.570         22.618   2013
25     1  12.66       10.565        8.645         24.849   2014
26     1  18.88        9.760        6.304         27.958   2015
27     1  42.52       10.420        9.260         21.433   2016
28     1  38.06       10.150        8.710         19.596   2017
29     1  39.66       11.130        9.540         23.191   2018
30     1  41.36       10.350        8.500         22.499   2019

Plotting the scatter matrix for the design matrix

Calculating parameter estimates
[-7.78400150e+03  3.55991655e-02 -6.87990540e+00  3.13357946e+00
 -6.34500307e-02  3.94222282e+00]

Predicting Lobster Landings
0      13.421079
1      22.732143
2      25.031995
3      32.640030
4      33.062184
5      33.416713
6      36.801398
7      43.132742
8      51.042073
9      53.626207
10     51.980783
11     57.376989
12     59.901457
13     63.099885
14     68.985310
15     69.503725
16     69.641117
17     75.174981
18     68.586431
19     75.680436
20     90.678493
21     97.376970
22     99.051521
23    103.827832
24    107.845597
25    108.912876
26    111.081874
27    121.001795
28    125.035909
29    124.665552
30    130.819604
dtype: float64

Calculating residuals
0      9.947640
1      5.336095
2      5.756651
3     -5.809582
4     -3.135720
5      5.532154
6      0.406926
7     -7.049299
8     -4.018802
9     -6.589371
10     1.513635
11    -0.161583
12   -11.283764
13     0.525860
14   -14.014362
15     2.070519
16    -0.911256
17     0.170846
18    -4.610473
19    -5.771932
20    -9.503855
21    -1.168198
22     5.873207
23    23.493590
24    19.962839
25    15.413047
26    11.581519
27    11.602896
28   -12.934698
29    -3.625564
30   -28.598965
dtype: float64

Verifying Orthogonality
ones            -2.119501e-08
cei             -6.036764e-07
sea_avg_max     -2.159692e-07
sea_avg_min     -1.778601e-07
sea_max_range   -5.332813e-07
years           -4.242802e-05
dtype: float64

Plotting the residuals

Calculating sigma squared estimates
137.98094316421728

Calculating z scores
[-13.94495288   0.23778813  -1.81728975   1.04898975  -0.28213185
  13.86791768]

Calculating total variability in target variable
1226.9104176059045

Calculating Explained variability
0.9100303062494409

Means of the design matrix
ones                1.000000
cei                28.512903
sea_avg_max        10.205484
sea_avg_min         8.411645
sea_max_range      25.142581
years            2004.000000
dtype: float64

Centering the design matrix
    ones        cei  sea_avg_max  sea_avg_min  sea_max_range  years
0    0.0 -13.912903    -0.605484    -1.011645      -4.342581  -15.0
1    0.0  15.167097    -0.905484    -0.311645      -5.542581  -14.0
2    0.0   1.587097    -0.555484     0.038355      -7.942581  -13.0
3    0.0 -13.312903    -1.605484    -0.911645      -7.142581  -12.0
4    0.0 -24.132903    -1.105484    -0.761645      -4.542581  -11.0
5    0.0 -20.212903    -0.305484    -0.111645      -0.442581  -10.0
6    0.0 -20.652903     0.094516     0.488355      -5.642581   -9.0
7    0.0   0.527097    -0.465484    -0.211645      -5.262581   -8.0
8    0.0 -20.652903    -1.885484    -1.860645      -7.136581   -7.0
9    0.0  20.587097    -0.945484    -0.651645      -4.810581   -6.0
10   0.0  12.687097     0.304516     0.428355      -3.379581   -5.0
11   0.0 -17.892903    -0.020484     0.523355      -3.520581   -4.0
12   0.0  -3.252903     0.269516     0.563355      -2.431581   -3.0
13   0.0  -7.632903     0.124516     0.078355      -1.396581   -2.0
14   0.0   2.327097    -0.015484     0.278355      -1.376581   -1.0
15   0.0  -8.512903    -0.045484     0.258355      48.767419    0.0
16   0.0  -1.232903     1.634516     1.628355      -1.685581    1.0
17   0.0  43.287097     2.384516     3.388355       3.805419    2.0
18   0.0 -18.272903     1.034516    -2.040645      13.497419    3.0
19   0.0  -3.812903     1.274516    -0.791645       7.597419    4.0
20   0.0 -12.752903    -0.015484     0.063355      10.437419    5.0
21   0.0  13.767097    -0.225484    -0.021645       0.449419    6.0
22   0.0  41.807097     0.314516     0.068355      -2.186581    7.0
23   0.0  22.207097     0.164516     0.233355      -1.915581    8.0
24   0.0  -9.772903    -0.040484     0.158355      -2.524581    9.0
25   0.0 -15.852903     0.359516     0.233355      -0.293581   10.0
26   0.0  -9.632903    -0.445484    -2.107645       2.815419   11.0
27   0.0  14.007097     0.214516     0.848355      -3.709581   12.0
28   0.0   9.547097    -0.055484     0.298355      -5.546581   13.0
29   0.0  11.147097     0.924516     1.128355      -1.951581   14.0
30   0.0  12.847097     0.144516     0.088355      -2.643581   15.0

Verifying centering
ones             0.000000e+00
cei              1.350031e-13
sea_avg_max      1.243450e-14
sea_avg_min      3.286260e-14
sea_max_range   -1.847411e-13
years            0.000000e+00
dtype: float64

Calcultaing the Sample Covariance matrix
                 0           1         2         3           4          5
ones           0.0    0.000000  0.000000  0.000000    0.000000   0.000000
cei            0.0  311.083801  5.767640  9.483045  -18.941542  54.318000
sea_avg_max    0.0    5.767640  0.757652  0.589003    2.312980   3.823667
sea_avg_min    0.0    9.483045  0.589003  1.107973    0.035391   2.025000
sea_max_range  0.0  -18.941542  2.312980  0.035391  105.815872  17.433933
years          0.0   54.318000  3.823667  2.025000   17.433933  82.666667

Computing the singular value decomposision
[[ 0.          0.9738277   0.01944089  0.02990336 -0.06698415  0.21424418]
 [ 0.          0.03400936 -0.03102153 -0.00529988 -0.90041821 -0.43255055]
 [ 0.         -0.22225015  0.01790941 -0.00573744 -0.42938713  0.8751445 ]
 [-0.         -0.03282891  0.56143478  0.8264471  -0.01499192 -0.02176422]
 [-0.         -0.0054864  -0.82651676  0.56216543  0.01273182  0.02545333]
 [ 1.          0.          0.          0.          0.          0.        ]]

Plotting a scree plot

Computing the singular vectors
            0          1          2         3         4    5
0  -16.513572   9.949373  -8.175414 -0.327699 -0.429027  0.0
1   12.115063  11.591913 -13.257428 -0.876055  0.063075  0.0
2   -0.717241  12.845806  -8.329338  0.069737  0.039954  0.0
3  -15.115438  11.223789  -4.499530 -0.849501  0.491126  0.0
4  -25.597962   8.065864  -2.327951 -0.150351  0.280111  0.0
5  -21.805958   4.046654  -4.073916  0.624067  0.040452  0.0
6  -21.646163   8.265725  -0.864447  1.415147  0.008807  0.0
7   -0.863521   8.232416  -4.865741 -0.200546 -0.007770  0.0
8  -21.226336   8.819721   1.505363 -1.658948  0.356669  0.0
9   19.047185   7.659776  -7.773945 -1.542525  0.088209  0.0
10  11.528933   5.625552  -5.741287  0.267963 -0.250783  0.0
11 -18.030507   4.289533   1.984445  1.148266  0.262673  0.0
12  -3.625537   3.365115  -0.856791  0.825435  0.004467  0.0
13  -7.763308   1.858740   0.547579  0.449710 -0.085677  0.0
14   2.152179   1.750197  -0.803130  0.187358  0.113532  0.0
15 -11.549904 -44.200549 -19.050405 -0.263667  0.850435  0.0
16  -0.793014   0.983911   1.892855  2.307404 -0.424793  0.0
17  42.475440  -2.911333  -9.481008  2.617399 -0.204160  0.0
18 -18.096950 -14.093701   0.921207 -0.773437 -1.653766  0.0
19  -3.363936  -8.736073   1.113130 -0.014478 -1.278983  0.0
20 -12.045458 -11.994369   2.727723  0.197032  0.378535  0.0
21  14.657110  -2.524649   1.994239 -0.733765  0.257108  0.0
22  42.367243   0.352697  -2.221492 -1.258978 -0.300562  0.0
23  23.478329  -0.986672   2.889759 -0.589210  0.052610  0.0
24  -7.415871  -1.951730  11.130719  0.270947  0.373038  0.0
25 -13.261922  -4.612697  12.405915  0.701893  0.171809  0.0
26  -7.284377  -7.595730  10.562713 -1.957345 -0.447963  0.0
27  16.489451  -1.385211   8.980475  0.156163  0.480976  0.0
28  12.461778  -0.304084  11.633960 -0.297778  0.421479  0.0
29  14.037210  -3.954023  10.622646  0.810193  0.140536  0.0
30  15.907051  -3.675960  11.409099 -0.554430  0.207883  0.0

Using 2 principle components
            0          1
0  -16.513572   9.949373
1   12.115063  11.591913
2   -0.717241  12.845806
3  -15.115438  11.223789
4  -25.597962   8.065864
5  -21.805958   4.046654
6  -21.646163   8.265725
7   -0.863521   8.232416
8  -21.226336   8.819721
9   19.047185   7.659776
10  11.528933   5.625552
11 -18.030507   4.289533
12  -3.625537   3.365115
13  -7.763308   1.858740
14   2.152179   1.750197
15 -11.549904 -44.200549
16  -0.793014   0.983911
17  42.475440  -2.911333
18 -18.096950 -14.093701
19  -3.363936  -8.736073
20 -12.045458 -11.994369
21  14.657110  -2.524649
22  42.367243   0.352697
23  23.478329  -0.986672
24  -7.415871  -1.951730
25 -13.261922  -4.612697
26  -7.284377  -7.595730
27  16.489451  -1.385211
28  12.461778  -0.304084
29  14.037210  -3.954023
30  15.907051  -3.675960

compute least squares estimate of gamma

Predicting centered target values
0    -28.355780
1     -6.590183
2    -19.232042
3    -29.024466
4    -33.286998
5    -24.260502
6    -30.243587
7    -12.665774
8    -30.692798
9      4.958645
10     1.566961
11   -21.428212
12    -7.937616
13    -9.243376
14    -0.722578
15    54.351056
16    -2.095604
17    40.048294
18     5.172366
19     9.830374
20     7.232474
21    16.023686
22    35.224025
23    21.233966
24    -3.424949
25    -4.497375
26     4.870049
27    15.916966
28    10.952060
29    17.573485
30    18.747432
dtype: float64

Unexplained variability in centered data
851.7821840786308

Calculating total variability in centered target variable
1226.9104176059045

explained variability using pstar principal comps
0.35203361734318894

Calculating z scores
[ 2.85256405 -2.91811594]
